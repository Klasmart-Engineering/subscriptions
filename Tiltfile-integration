docker_build('local-go-image', '.',
    dockerfile='Dockerfile-debug',
    )

k8s_yaml('./environment/integration/go.yaml')
k8s_yaml('./environment/integration/postgres.yaml')

k8s_resource('go-app', labels=['subscriptions'], port_forwards=['8020:8080', '40002:40000'], resource_deps=['postgres'])
k8s_resource('postgres', labels=['subscriptions'], port_forwards=1334)

k8s_yaml('./environment/integration/localstack.yaml')
k8s_resource('localstack', labels=['localstack'], port_forwards=['4568:4566'])
